- type: entity
  name: anomaly obsession trap
  id: BaseAnomalyTrap
  abstract: true
  components:
  - type: Physics
    bodyType: Static
    fixedRotation: true
  - type: TriggerOnCollide
    fixtureID: anom
    ignoreOtherNonHard: false
  - type: Fixtures
    fixtures:
      anom:
        shape:
          !type:PhysShapeCircle
          radius: 2.27 # i love 27
        hard: false
        mask:
        - MobMask
        layer:
        - MobLayer
  - type: DeleteOnTrigger
  - type: AddCompOnTrigger
    toOther: true


- type: entity
  parent: BaseAnomalyTrap
  id: AnomalyTrapPyroclastic
  suffix: Pyroclastic
  components:
  - type: AddCompOnTrigger
    components:
    - type: InnerBodyAnomaly
      startMessage: inner-anomaly-start-message-pyro
      layerSprite:
        sprite: Structures/Specific/Anomalies/inner_anom_layer.rsi
        state: fire_eyes
      components:
      - type: Anomaly
        maxPointsPerSecond: 40
        deleteEntity: false
        corePrototype: AnomalyCorePyroclastic
      - type: PointLight
        radius: 1.3
        energy: 2.5
        color: "#E25822"
        castShadows: false
      - type: PyroclasticAnomaly
        maximumIgnitionRadius: 3
      - type: TempAffectingAnomaly
        tempChangePerSecond: 10
        hotspotExposeTemperature: 500
      - type: GasProducerAnomaly
        releasedGas: 3
        releaseOnMaxSeverity: true
        spawnRadius: 4
        tileCount: 5
        tempChange: 420
      - type: ProjectileAnomaly
        projectilePrototype: ProjectileAnomalyFireball
        projectileSpeed: 0.5
        minProjectiles: 1
        maxProjectiles: 3
      - type: DamageOnAttacked
        damage:
          types:
            Heat: 3

- type: entity
  parent: BaseAnomalyTrap
  id: AnomalyTrapElectric
  suffix: Electric
  components:
  - type: AddCompOnTrigger
    components:
    - type: InnerBodyAnomaly
      startMessage: inner-anomaly-start-message-shock
      layerSprite:
        sprite: Structures/Specific/Anomalies/inner_anom_layer.rsi
        state: shock_eyes
      components:
      - type: Anomaly
        maxPointsPerSecond: 40
        deleteEntity: false
        corePrototype: AnomalyCoreElectricity
      - type: PointLight
        radius: 1.3
        energy: 2.5
        color: "#ffffaa"
        castShadows: false
      - type: ElectricityAnomaly
        minBoltCount: 1
        maxBoltCount: 3
        maxElectrocuteRange: 4
        maxElectrocuteDamage: 10
        maxElectrocuteDuration: 4
      - type: DamageOnAttacked
        damage:
          types:
            Shock: 3

- type: entity
  parent: BaseAnomalyTrap
  id: AnomalyTrapShadow
  suffix: Shadow
  components:
  - type: AddCompOnTrigger
    components:
    - type: InnerBodyAnomaly
      startMessage: inner-anomaly-start-message-shadow
      layerSprite:
        sprite: Structures/Specific/Anomalies/inner_anom_layer.rsi
        state: shadow_eyes
      components:
      - type: Anomaly
        maxPointsPerSecond: 40
        deleteEntity: false
        corePrototype: AnomalyCoreShadow
      - type: PointLight
        radius: 1.3
        energy: 2.5
        color: "#793a80"
      - type: EntitySpawnAnomaly
        entries:
        - settings:
            spawnOnPulse: true
            spawnOnSuperCritical: true
            minAmount: 5
            maxAmount: 10
            maxRange: 2
          spawns:
          - ShadowKudzuWeak
        - settings:
            spawnOnSuperCritical: true
            minAmount: 15
            maxAmount: 20
            maxRange: 25
          spawns:
          - ShadowKudzu
      - type: DamageOnAttacked
        damage:
          types:
            Cold: 3

- type: entity
  parent: BaseAnomalyTrap
  id: AnomalyTrapIce
  suffix: Ice
  components:
  - type: AddCompOnTrigger
    components:
    - type: InnerBodyAnomaly
      startMessage: inner-anomaly-start-message-frost
      layerSprite:
        sprite: Structures/Specific/Anomalies/inner_anom_layer.rsi
        state: frost_eyes
      components:
      - type: Anomaly
        maxPointsPerSecond: 40
        deleteEntity: false
        corePrototype: AnomalyCoreIce
      - type: PointLight
        radius: 1.3
        energy: 2.5
        color: "#befaff"
      - type: ExplosionAnomaly
        supercriticalExplosion: Cryo
        explosionTotalIntensity: 150
        explosionDropoff: 2
        explosionMaxTileIntensity: 20
      - type: ProjectileAnomaly
        projectilePrototype: ProjectileIcicle
        minProjectiles: 1
        maxProjectiles: 4
      - type: EntitySpawnAnomaly
        entries:
        - settings:
            spawnOnStabilityChanged: true
            minAmount: 3
            maxAmount: 8
            maxRange: 2
          spawns:
          - IceCrust
      - type: TempAffectingAnomaly
        tempChangePerSecond: -10
        hotspotExposeTemperature: -500
      - type: GasProducerAnomaly
        releasedGas: 8 # Frezon. Please replace if there is a better way to specify this
        releaseOnMaxSeverity: true
        spawnRadius: 0
      - type: DamageOnAttacked
        damage:
          types:
            Cold: 3