using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Options;

[GenerateTypedNameReferences]
public sealed partial class AbandonCharacter : DefaultWindow
{
    [Dependency] private readonly IClientConsoleHost _console = default!;

    public AbandonCharacter()
    {
        IoCManager.InjectDependencies(this);
        RobustXamlLoader.Load(this);

        ConfirmAbandonButton.StyleClasses.Add("negative");

        SuicideButton.OnPressed += _ => RunActionIfSure("suicide");
        GhostButton.OnPressed += _ => RunActionIfSure("ghost");
    }

    private void RunActionIfSure(string command)
    {
        AbandonConfirmContainer.Visible = true;
        AbandonMethodContainer.Visible = false;

        Description.Text = Loc.GetString("ban-panel-confirm");
        CancelAbandonButton.OnPressed += _ => Close();
        ConfirmAbandonButton.OnPressed += _ =>
        {
            _console.ExecuteCommand(command);
            Close();
        };
    }
}
