using Content.Shared.Audio.Jukebox;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Prototypes;

namespace Content.Client.Audio.Jukebox;

[GenerateTypedNameReferences]
public sealed partial class QueuedTrackControl : Control
{
    public Action<int>? OnDeletePressed;
    public Action<int>? OnMoveUpPressed;
    public Action<int>? OnMoveDownPressed;

    private ProtoId<JukeboxPrototype> _trackId;
    private int _index;

    public QueuedTrackControl(JukeboxPrototype track, int index, bool disableMoveUp, bool disableMoveDown)
    {
        RobustXamlLoader.Load(this);

        SetTrackInfo(track);
        SetIndex(index);
        SetButtonStatus(disableMoveUp, disableMoveDown);

        MoveUp.OnPressed += (_) =>
        {
            OnMoveUpPressed?.Invoke(_index);
        };

        MoveDown.OnPressed += (_) =>
        {
            OnMoveDownPressed?.Invoke(_index);
        };

        Delete.OnPressed += (_) =>
        {
            OnDeletePressed?.Invoke(_index);
        };
    }

    public void SetTrackInfo(JukeboxPrototype track)
    {
        TrackName.Text = track.Name;
        TrackArtist.Text = track.Artist;
        _trackId = track.ID;
    }

    public void SetIndex(int index)
    {
        _index = index;
    }

    public void SetButtonStatus(bool disableMoveUp, bool disableMoveDown)
    {
        MoveUp.Disabled = disableMoveUp;
        MoveDown.Disabled = disableMoveDown;
    }
}
