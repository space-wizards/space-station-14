using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.CustomControls;
using Robust.Client.UserInterface.XAML;

namespace Content.Client.Weapons.Melee.UI;

[GenerateTypedNameReferences]
public sealed partial class MeleeSpeechWindow : DefaultWindow
{

    public event Action<string>? OnBattlecryChanged;

	public MeleeSpeechWindow()
	{
        RobustXamlLoader.Load(this);

		BattlecryLineEdit.OnTextChanged += e => OnBattlecryChanged?.Invoke(e.Text);
	}

	public void SetCurrentBattlecry(string battlecry)
	{
        if (!BattlecryLineEdit.HasKeyboardFocus())
            BattlecryLineEdit.Text = battlecry;
	}

    public void SetInitialBattlecry(string? battlecry)
    {
        if (battlecry != null)
        {
            BattlecryLineEdit.Text = battlecry;
            BattlecryLineEdit.CursorPosition = battlecry.Length;
            BattlecryLineEdit.SelectionStart = 0;
        }

        BattlecryLineEdit.GrabKeyboardFocus();
    }

    public void SetMaxBattlecryLength(int maxLength)
    {
        BattlecryLineEdit.IsValid = s => s.Length <= maxLength;
    }
}


