using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Timing;

namespace Content.Client.Instruments.UI;

[GenerateTypedNameReferences]
public sealed partial class InputMidiSource : InstrumentMidiSourceBase
{
    public event Action? OpenInputRequest;
    public event Action? CloseInputRequest;

    public override string ButtonName => Loc.GetString("instruments-component-menu-input-midi-source-button");

    public InputMidiSource()
    {
        RobustXamlLoader.Load(this);
    }

    public override void Enable()
    {
        base.Enable();
        // Another timer because rushing the MIDI-Renderer often breaks it.
        Timer.Spawn(1000,
            () =>
        {
            if (Enabled)
                OpenInputRequest?.Invoke();
        });
    }

    public override void Disable()
    {
        base.Disable();
        CloseInputRequest?.Invoke();
    }
}
